package core.pages;

import com.codeborne.selenide.Condition;
import com.codeborne.selenide.Selenide;
import core.element.SElement;
import org.openqa.selenium.By;
import org.openqa.selenium.Keys;
import ru.yandex.qatools.allure.annotations.Step;

/**
 * Created by Aleks on 27.06.2017.
 */
public class NewLetterPage extends InboxPage {
    private SElement sendButton;
    private SElement sendTo;
    private SElement subject;
    private SElement body;

    public NewLetterPage() {
        sendButton = new SElement(By.xpath("//button[@title='Отправить письмо (Ctrl + Enter)']"));
        sendButton.getW().waitUntil(Condition.visible, 10000);
        sendTo = new SElement(By.xpath("//div[text() = 'Кому']/following-sibling::div[1]//div"), "Кому");
        subject = new SElement(By.xpath("//input[@name = 'subj']"), "Тема");
        body = new SElement(By.xpath("//div[@id ='cke_editor1']//div[@role='textbox']"), "Тело письма");
    }

    @Step("ЗАполняем и отправляем письмо адресат {0} тема {1}")
    public InboxPage fillAndSendLetter(String sendToText, String sbjText) {
        sendTo.sendKeys(sendToText);
        Selenide.actions().sendKeys(Keys.ENTER).build().perform();
        subject.sendKeys(sbjText);
        body.sendKeys("bla bla bla :)");
        sendButton.click();
        return new InboxPage();
    }
}
